// Script to bulk insert Greek municipality categories and subcategories
// Based on the Greek municipality navigation structure

const { initializeApp } = require('firebase/app');
const { getFirestore, collection, addDoc, getDocs, query, where } = require('firebase/firestore');

// Your Firebase config (you'll need to add this)
const firebaseConfig = {
  // Add your Firebase config here
  // apiKey: "your-api-key",
  // authDomain: "your-auth-domain",
  // projectId: "your-project-id",
  // storageBucket: "your-storage-bucket",
  // messagingSenderId: "your-messaging-sender-id",
  // appId: "your-app-id"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Greek Municipality Categories Structure
const categoryStructure = [
  {
    // Main Category 1: Municipality
    name: { en: 'Municipality', el: 'ŒîŒÆŒºŒøœÇ' },
    description: { en: 'Municipal government and administration', el: 'ŒîŒ∑ŒºŒøœÑŒπŒ∫ŒÆ Œ¥ŒπŒøŒØŒ∫Œ∑œÉŒ∑ Œ∫Œ±Œπ Œ¥ŒπŒ±Œ∫œÖŒ≤Œ≠œÅŒΩŒ∑œÉŒ∑' },
    icon: 'building',
    color: 'blue',
    isActive: true,
    showInNavbar: true,
    slug: 'municipality',
    subcategories: [
      {
        name: { en: 'Vision & Mission', el: 'ŒåœÅŒ±ŒºŒ± & ŒëœÄŒøœÉœÑŒøŒªŒÆ' },
        description: { en: 'Our vision and mission statement', el: 'Œ§Œø œåœÅŒ±ŒºŒ± Œ∫Œ±Œπ Œ∑ Œ±œÄŒøœÉœÑŒøŒªŒÆ ŒºŒ±œÇ' },
        icon: 'eye',
        color: 'blue',
        slug: 'vision-mission'
      },
      {
        name: { en: 'Mayor', el: 'ŒîŒÆŒºŒ±œÅœáŒøœÇ' },
        description: { en: 'Information about the Mayor', el: 'Œ†ŒªŒ∑œÅŒøœÜŒøœÅŒØŒµœÇ Œ≥ŒπŒ± œÑŒøŒΩ ŒîŒÆŒºŒ±œÅœáŒø' },
        icon: 'user',
        color: 'blue',
        slug: 'mayor'
      },
      {
        name: { en: 'Administration', el: 'ŒîŒπŒøŒØŒ∫Œ∑œÉŒ∑' },
        description: { en: 'Municipal administration structure', el: 'ŒîŒøŒºŒÆ Œ¥Œ∑ŒºŒøœÑŒπŒ∫ŒÆœÇ Œ¥ŒπŒøŒØŒ∫Œ∑œÉŒ∑œÇ' },
        icon: 'users',
        color: 'blue',
        slug: 'administration'
      },
      {
        name: { en: 'Municipal Council', el: 'ŒîŒ∑ŒºŒøœÑŒπŒ∫œå Œ£œÖŒºŒ≤ŒøœçŒªŒπŒø' },
        description: { en: 'Municipal council members and meetings', el: 'ŒúŒ≠ŒªŒ∑ Œ∫Œ±Œπ œÉœÖŒΩŒµŒ¥œÅŒπŒ¨œÉŒµŒπœÇ Œ¥Œ∑ŒºŒøœÑŒπŒ∫Œøœç œÉœÖŒºŒ≤ŒøœÖŒªŒØŒøœÖ' },
        icon: 'users',
        color: 'blue',
        slug: 'municipal-council'
      },
      {
        name: { en: 'Municipal Committees', el: 'ŒîŒ∑ŒºŒøœÑŒπŒ∫Œ≠œÇ ŒïœÄŒπœÑœÅŒøœÄŒ≠œÇ' },
        description: { en: 'Various municipal committees', el: 'ŒîŒπŒ¨œÜŒøœÅŒµœÇ Œ¥Œ∑ŒºŒøœÑŒπŒ∫Œ≠œÇ ŒµœÄŒπœÑœÅŒøœÄŒ≠œÇ' },
        icon: 'users',
        color: 'blue',
        slug: 'municipal-committees'
      },
      {
        name: { en: 'Decisions', el: 'ŒëœÄŒøœÜŒ¨œÉŒµŒπœÇ' },
        description: { en: 'Municipal decisions and resolutions', el: 'ŒîŒ∑ŒºŒøœÑŒπŒ∫Œ≠œÇ Œ±œÄŒøœÜŒ¨œÉŒµŒπœÇ Œ∫Œ±Œπ œàŒ∑œÜŒØœÉŒºŒ±œÑŒ±' },
        icon: 'file-text',
        color: 'blue',
        slug: 'decisions'
      }
    ]
  },
  {
    // Main Category 2: Services
    name: { en: 'Services', el: 'Œ•œÄŒ∑œÅŒµœÉŒØŒµœÇ' },
    description: { en: 'Municipal services and departments', el: 'ŒîŒ∑ŒºŒøœÑŒπŒ∫Œ≠œÇ œÖœÄŒ∑œÅŒµœÉŒØŒµœÇ Œ∫Œ±Œπ œÑŒºŒÆŒºŒ±œÑŒ±' },
    icon: 'settings',
    color: 'green',
    isActive: true,
    showInNavbar: true,
    slug: 'services',
    subcategories: [
      {
        name: { en: 'Structure', el: 'ŒîŒøŒºŒÆ' },
        description: { en: 'Organizational structure of services', el: 'ŒüœÅŒ≥Œ±ŒΩœâœÑŒπŒ∫ŒÆ Œ¥ŒøŒºŒÆ œÖœÄŒ∑œÅŒµœÉŒπœéŒΩ' },
        icon: 'organization',
        color: 'green',
        slug: 'structure'
      },
      {
        name: { en: 'Social Programs', el: 'ŒöŒøŒπŒΩœâŒΩŒπŒ∫Œ¨ Œ†œÅŒøŒ≥œÅŒ¨ŒºŒºŒ±œÑŒ±' },
        description: { en: 'Community and social programs', el: 'ŒöŒøŒπŒΩŒøœÑŒπŒ∫Œ¨ Œ∫Œ±Œπ Œ∫ŒøŒπŒΩœâŒΩŒπŒ∫Œ¨ œÄœÅŒøŒ≥œÅŒ¨ŒºŒºŒ±œÑŒ±' },
        icon: 'heart',
        color: 'green',
        slug: 'social-programs'
      }
    ]
  },
  {
    // Main Category 3: Culture
    name: { en: 'Culture', el: 'Œ†ŒøŒªŒπœÑŒπœÉŒºœåœÇ' },
    description: { en: 'Cultural activities and events', el: 'Œ†ŒøŒªŒπœÑŒπœÉœÑŒπŒ∫Œ≠œÇ Œ¥œÅŒ±œÉœÑŒ∑œÅŒπœåœÑŒ∑œÑŒµœÇ Œ∫Œ±Œπ ŒµŒ∫Œ¥Œ∑ŒªœéœÉŒµŒπœÇ' },
    icon: 'palette',
    color: 'purple',
    isActive: true,
    showInNavbar: true,
    slug: 'culture',
    subcategories: []
  },
  {
    // Main Category 4: Citizen Services
    name: { en: 'Citizen Services', el: 'ŒïŒæœÖœÄŒ∑œÅŒ≠œÑŒ∑œÉŒ∑ Œ†ŒøŒªŒπœÑœéŒΩ' },
    description: { en: 'Services for citizens', el: 'Œ•œÄŒ∑œÅŒµœÉŒØŒµœÇ Œ≥ŒπŒ± œÑŒøœÖœÇ œÄŒøŒªŒØœÑŒµœÇ' },
    icon: 'users',
    color: 'orange',
    isActive: true,
    showInNavbar: true,
    slug: 'citizen-services',
    subcategories: [
      {
        name: { en: 'Service Office', el: 'ŒìœÅŒ±œÜŒµŒØŒø ŒïŒæœÖœÄŒ∑œÅŒ≠œÑŒ∑œÉŒ∑œÇ' },
        description: { en: 'Citizen service office information', el: 'Œ†ŒªŒ∑œÅŒøœÜŒøœÅŒØŒµœÇ Œ≥œÅŒ±œÜŒµŒØŒøœÖ ŒµŒæœÖœÄŒ∑œÅŒ≠œÑŒ∑œÉŒ∑œÇ œÄŒøŒªŒπœÑœéŒΩ' },
        icon: 'info',
        color: 'orange',
        slug: 'service-office'
      },
      {
        name: { en: 'Complaints', el: 'Œ†Œ±œÅŒ¨œÄŒøŒΩŒ±' },
        description: { en: 'Submit complaints and feedback', el: 'Œ•œÄŒøŒ≤ŒøŒªŒÆ œÄŒ±œÅŒ±œÄœåŒΩœâŒΩ Œ∫Œ±Œπ œÉœáŒøŒªŒØœâŒΩ' },
        icon: 'message-square',
        color: 'orange',
        slug: 'complaints'
      },
      {
        name: { en: 'Forms & Applications', el: 'ŒàŒΩœÑœÖœÄŒ± / ŒëŒπœÑŒÆœÉŒµŒπœÇ' },
        description: { en: 'Download forms and submit applications', el: 'ŒõŒÆœàŒ∑ ŒµŒΩœÑœçœÄœâŒΩ Œ∫Œ±Œπ œÖœÄŒøŒ≤ŒøŒªŒÆ Œ±ŒπœÑŒÆœÉŒµœâŒΩ' },
        icon: 'file-text',
        color: 'orange',
        slug: 'forms-applications'
      },
      {
        name: { en: 'Online Payments', el: 'ŒîŒπŒ±Œ¥ŒπŒ∫œÑœÖŒ±Œ∫Œ≠œÇ Œ†ŒªŒ∑œÅœâŒºŒ≠œÇ' },
        description: { en: 'e-payments and online payment services', el: 'ŒóŒªŒµŒ∫œÑœÅŒøŒΩŒπŒ∫Œ≠œÇ œÄŒªŒ∑œÅœâŒºŒ≠œÇ Œ∫Œ±Œπ Œ¥ŒπŒ±Œ¥ŒπŒ∫œÑœÖŒ±Œ∫Œ≠œÇ œÖœÄŒ∑œÅŒµœÉŒØŒµœÇ œÄŒªŒ∑œÅœâŒºŒÆœÇ' },
        icon: 'credit-card',
        color: 'orange',
        slug: 'online-payments'
      },
      {
        name: { en: 'Offers', el: 'Œ†œÅŒøœÉœÜŒøœÅŒ≠œÇ' },
        description: { en: 'Current offers and announcements', el: 'Œ§œÅŒ≠œáŒøœÖœÉŒµœÇ œÄœÅŒøœÉœÜŒøœÅŒ≠œÇ Œ∫Œ±Œπ Œ±ŒΩŒ±Œ∫ŒøŒπŒΩœéœÉŒµŒπœÇ' },
        icon: 'tag',
        color: 'orange',
        slug: 'offers'
      },
      {
        name: { en: 'Community Leaders', el: 'ŒöŒøŒπŒΩŒøœÑŒ¨œÅœáŒµœÇ' },
        description: { en: 'Information about community leaders', el: 'Œ†ŒªŒ∑œÅŒøœÜŒøœÅŒØŒµœÇ Œ≥ŒπŒ± Œ∫ŒøŒπŒΩŒøœÑŒ¨œÅœáŒµœÇ' },
        icon: 'crown',
        color: 'orange',
        slug: 'community-leaders'
      }
    ]
  },
  {
    // Main Category 5: Civil Marriages
    name: { en: 'Civil Marriages', el: 'Œ†ŒøŒªŒπœÑŒπŒ∫ŒøŒØ ŒìŒ¨ŒºŒøŒπ' },
    description: { en: 'Civil marriage services and information', el: 'Œ•œÄŒ∑œÅŒµœÉŒØŒµœÇ Œ∫Œ±Œπ œÄŒªŒ∑œÅŒøœÜŒøœÅŒØŒµœÇ œÄŒøŒªŒπœÑŒπŒ∫œéŒΩ Œ≥Œ¨ŒºœâŒΩ' },
    icon: 'heart',
    color: 'pink',
    isActive: true,
    showInNavbar: true,
    slug: 'civil-marriages',
    subcategories: []
  },
  {
    // Main Category 6: Contact
    name: { en: 'Contact', el: 'ŒïœÄŒπŒ∫ŒøŒπŒΩœâŒΩŒØŒ±' },
    description: { en: 'Contact information and communication', el: 'Œ£œÑŒøŒπœáŒµŒØŒ± ŒµœÄŒπŒ∫ŒøŒπŒΩœâŒΩŒØŒ±œÇ Œ∫Œ±Œπ ŒµœÄŒπŒ∫ŒøŒπŒΩœâŒΩŒØŒ±' },
    icon: 'phone',
    color: 'gray',
    isActive: true,
    showInNavbar: true,
    slug: 'contact',
    subcategories: []
  }
];

async function checkCategoryExists(slug) {
  try {
    const q = query(collection(db, 'pageCategories'), where('slug', '==', slug));
    const querySnapshot = await getDocs(q);
    return !querySnapshot.empty;
  } catch (error) {
    console.error('Error checking category existence:', error);
    return false;
  }
}

async function insertCategories() {
  try {
    console.log('üöÄ Starting bulk insertion of Greek municipality categories...\n');
    
    let mainCategoriesCreated = 0;
    let subcategoriesCreated = 0;
    let skipped = 0;
    
    for (const categoryData of categoryStructure) {
      const { subcategories, ...mainCategoryData } = categoryData;
      
      console.log(`üìÇ Processing main category: ${mainCategoryData.name.en} (${mainCategoryData.name.el})`);
      
      // Check if main category already exists
      const exists = await checkCategoryExists(mainCategoryData.slug);
      if (exists) {
        console.log(`  ‚è≠Ô∏è  Main category already exists, skipping...`);
        skipped++;
      } else {
        // Create main category
        const mainCategoryRef = await addDoc(collection(db, 'pageCategories'), mainCategoryData);
        console.log(`  ‚úÖ Created main category with ID: ${mainCategoryRef.id}`);
        mainCategoriesCreated++;
        
        // Create subcategories
        if (subcategories && subcategories.length > 0) {
          console.log(`  üìã Creating ${subcategories.length} subcategories...`);
          
          for (const subcategoryData of subcategories) {
            const subcategoryWithParent = {
              ...subcategoryData,
              parentCategory: mainCategoryRef.id,
              isActive: true,
              showInNavbar: false // Subcategories typically don't show in main navbar
            };
            
            const subcatExists = await checkCategoryExists(subcategoryData.slug);
            if (subcatExists) {
              console.log(`    ‚è≠Ô∏è  Subcategory ${subcategoryData.name.en} already exists, skipping...`);
              skipped++;
            } else {
              const subcategoryRef = await addDoc(collection(db, 'pageCategories'), subcategoryWithParent);
              console.log(`    ‚úÖ Created subcategory: ${subcategoryData.name.en} (${subcategoryData.name.el}) - ID: ${subcategoryRef.id}`);
              subcategoriesCreated++;
            }
          }
        }
      }
      
      console.log(''); // Empty line for readability
    }
    
    console.log('üéâ Bulk insertion completed successfully!');
    console.log(`üìä Summary:`);
    console.log(`  - Main categories created: ${mainCategoriesCreated}`);
    console.log(`  - Subcategories created: ${subcategoriesCreated}`);
    console.log(`  - Items skipped (already exist): ${skipped}`);
    console.log(`  - Total items processed: ${mainCategoriesCreated + subcategoriesCreated + skipped}`);
    
    if (mainCategoriesCreated > 0 || subcategoriesCreated > 0) {
      console.log('\nüí° Next steps:');
      console.log('1. Restart your Next.js development server');
      console.log('2. Check the navbar - categories should now appear');
      console.log('3. Go to Admin > Categories to manage and create pages for these categories');
      console.log('4. Run the navbar categories migration if needed: node scripts/migrate-categories-navbar.js');
    }
    
  } catch (error) {
    console.error('‚ùå Error during bulk insertion:', error);
  }
}

// Run the insertion
insertCategories()
  .then(() => {
    console.log('\n‚ú® Script completed.');
    process.exit(0);
  })
  .catch((error) => {
    console.error('\nüí• Script failed:', error);
    process.exit(1);
  });
